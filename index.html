<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Planner</title>
    <link rel="icon" sizes="192x192" type="image/png" href="/TaskPlanner/192x192.png">
    <link rel="icon" type="image/x-icon" href="/TaskPlanner/192x192.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <link rel="manifest" href="/TaskPlanner/manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
</head>
<body>
    <div id="entry-page">
        <div id="entry-container">
            <div id="entry-content">
                <select id="entry-language-select" onchange="updateEntryPopupLanguage()">
                    <option value="en">EN</option>
                    <option value="zh">ZH</option>
                    <option value="es">ES</option>
                    <option value="de">DE</option>
                    <option value="fr">FR</option>
                    <option value="it">IT</option>
                    <option value="ro">RO</option>
                    <option value="pt">PT</option>
                </select>
                <span class="material-icons lock-icon">lock</span>
                <h3 id="entry-title">Password</h3>
                <p id="entry-message"></p>
                <div>
                    <input type="password" id="entry-password" placeholder="Enter your password" autocomplete="off" oninput="showConfirmPasswordField()">
                    <span id="toggle-password-visibility" class="material-icons" onclick="togglePasswordVisibility()">visibility_off</span>
                </div>
                <div id="confirm-password-container" style="display: none;">
                    <input type="password" id="entry-confirm-password" placeholder="Confirm your password" autocomplete="off">
                    <span id="toggle-confirm-password-visibility" class="material-icons" onclick="togglePasswordVisibility(true)" style="display: none;">visibility_off</span>
                </div>
                <button id="entry-button" onclick="handleEntry()">Submit</button>
            </div>
        </div>
    </div>
    <div class="overlay" id="overlay"></div>
    <div class="popup" id="popup">
        <span class="close-popup" onclick="closePopup()">&#10006;</span>
        <h3 style="text-align: center;">Add / Edit Task</h3>
        <div id="validation-error" style="display: none; padding: 10px; margin: 10px 0; border-radius: 4px; background-color: #ffebee; color: #c62828; border-left: 4px solid #c62828; font-size: 14px; word-wrap: break-word;"></div>
        <div style="display: flex; align-items: center; justify-content: flex-start; margin-top: 10px;">
            <label class="switch">
            <input type="checkbox" id="taskPriority" onchange="togglePriorityLabel()">
            <span class="slider"></span>
            </label>
            <label for="taskPriority" id="priorityLabel" style="margin-left: 10px;">Assign Priority</label>
        </div>
        <script>
            function togglePriorityLabel() {
                const checkbox = document.getElementById('taskPriority');
                const label = document.getElementById('priorityLabel');
                const language = localStorage.getItem('language') || 'en';
                label.textContent = checkbox.checked 
                    ? translations[language].removePriority 
                    : translations[language].assignPriority;
            }
        </script>
        <textarea id="taskDescription" placeholder="Description" autocomplete="off"></textarea>
        <input type="date" id="taskDate" autocomplete="off">
        <input list="assignedToList" id="taskAssignedTo" placeholder="Assigned To" autocomplete="off" onfocus="showAllOptions()" onclick="showAllOptions()">
        <datalist id="assignedToList" style="display: none; position: absolute; max-height: 150px; overflow-y: auto;"></datalist>
        <div class="button-container">
            <button onclick="deleteTask()" class="popup-button">Delete</button>
            <button onclick="saveTask()" class="popup-button">Save</button>
        </div>
    </div>

    <!-- Confirmation Modal for Delete Done Tasks -->
    <div class="overlay" id="confirmation-overlay" onclick="closeConfirmationModal()"></div>
    <div class="popup" id="confirmation-modal">
        <h3 id="confirmation-title" style="text-align: center;">Confirm Delete</h3>
        <p id="confirmation-message" style="text-align: center; margin: 20px 0;">Are you sure you want to delete all tasks in the Done column?</p>
        <div class="button-container">
            <button id="confirmation-cancel" onclick="closeConfirmationModal()" class="popup-button">Cancel</button>
            <button id="confirmation-confirm" onclick="confirmDeleteDoneTasks_Modal()" class="popup-button" style="background-color: #d32f2f; color: white;">Delete</button>
        </div>
    </div>

    <div class="column" id="todo-column">
        <div class="row">
            <div class="button-container">
                <span class="material-icons add-task-icon" onclick="openPopup('todo-column')">add_circle</span>
                <span class="material-icons copy-icon" onclick="copyTasksToClipboard('todo-column')" translate="no">content_copy</span>
            </div>
            <h2>To Do</h2>
        </div>
        <hr>
        <div class="date-tile" id="date-tile" onclick="reorderTasks()">
            <div id="tile-day-of-week"></div>
            <div id="tile-current-date"></div>
        </div>
        <div class="date-tile" id="filter-tile" onclick="openFilterPopup()">
            <div id="tile-filter-value">All Tasks</div>
        </div>
    </div>
    <div class="column" id="in-progress-column">
        <div class="row">
            <div class="button-container">
                <span class="material-icons add-task-icon" onclick="openPopup('in-progress-column')">add_circle</span>
                <span class="material-icons copy-icon" onclick="copyTasksToClipboard('in-progress-column')" translate="no">content_copy</span>
            </div>
            <h2>In Progress</h2>
        </div>
        <hr>
    </div>
    <div class="column" id="done-column">
        <div class="row">
            <div class="button-container">
                <span class="material-icons delete-icon" onclick="confirmDeleteDoneTasks()">delete</span>
                <span class="material-icons copy-icon" onclick="copyTasksToClipboard('done-column')" translate="no">content_copy</span>
            </div>
            <h2>Done</h2>
        </div>
        <hr>
    </div>

    <div class="task-context-menu" id="task-context-menu">
        <button onclick="copyTaskToClipboard()" class="context-menu-button" id="copy-task-button">
            <span class="material-icons">content_copy</span>
            <span id="copy-task-text">Copy Task</span>
        </button>
        <button onclick="moveTaskToToDo()" class="context-menu-button" id="move-to-todo-button" style="display:none;">
            <span class="material-icons">assignment</span>
            <span id="move-to-todo-text">Move to To Do</span>
        </button>
        <button onclick="moveTaskToInProgress()" class="context-menu-button" id="move-to-in-progress-button" style="display:none;">
            <span class="material-icons">play_arrow</span>
            <span id="move-to-in-progress-text">Move to In Progress</span>
        </button>
        <button onclick="moveTaskToDone()" class="context-menu-button" id="move-to-done-button" style="display:none;">
            <span class="material-icons">check_circle</span>
            <span id="move-to-done-text">Move to Done</span>
        </button>
        <button onclick="eliminateTask()" class="context-menu-button" id="eliminate-button">
            <span class="material-icons">delete</span>
            <span id="eliminate-text">Eliminate</span>
        </button>
    </div>

    <div class="settings-popup" id="settings-popup">
        <span class="close-popup" onclick="closeSettings()">&#10006;</span>
        <h2>Menu</h2>
        <hr>
        <h3 style="margin-bottom: 3px;">File</h3>
        <div class="button-container">
            <button onclick="document.getElementById('loadFile').click()">Load</button>
            <button onclick="exportTasks()">Export</button>
        </div>
        <input type="file" id="loadFile" accept=".json" onchange="loadFile(event)">
        <hr>
        <h3 style="margin-bottom: 3px;">Settings</h3>
        <div class="options-container">
            <label for="darkModeToggle">Dark Mode</label>
            <label class="switch">
                <input type="checkbox" id="darkModeToggle" onclick="toggleDarkMode()">
                <span class="slider"></span>
            </label>
        </div>
        <div class="options-container">
            <label for="taskStyleToggle">One Color</label>
            <label class="switch">
                <input type="checkbox" id="taskStyleToggle" onclick="toggleTaskStyle()">
                <span class="slider"></span>
            </label>
        </div>
        <div class="options-container">
            <label>Font Style</label>
            <div class="font-style-buttons">
                <button id="fontStyleNormal" class="font-style-btn selected" onclick="changeFontStyle('normal')" title="Normal" style="font-weight: normal;">N</button>
                <button id="fontStyleBold" class="font-style-btn" onclick="changeFontStyle('bold')" title="Bold" style="font-weight: bold;">B</button>
                <button id="fontStyleItalic" class="font-style-btn" onclick="changeFontStyle('italic')" title="Italic" style="font-style: italic;">I</button>
            </div>
        </div>
        <div class="options-container">
            <label for="fontFamily">Font Family</label>
            <select id="fontFamily" onchange="changeFontFamily()">
                <option value="Arial">Arial</option>
                <option value="Verdana">Verdana</option>
                <option value="Roboto">Roboto</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Courier New">Courier New</option>
            </select>
        </div>
        <div class="options-container">
            <label for="languageSelect">Language</label>
            <select id="languageSelect" onchange="changeLanguage()">
                <option value="en">English</option>
                <option value="zh">Chinese</option>
                <option value="es">Spanish</option>
                <option value="de">German</option>
                <option value="fr">French</option>
                <option value="it">Italian</option>
                <option value="ro">Romanian</option>
                <option value="pt">Portuguese</option>
            </select>
        </div>
        <hr>
        <h3 style="margin-bottom: 3px;">About</h3>
        <p></p> <!-- Placeholder for dynamically set version -->
        <footer style="font-size: smaller;"></footer> <!-- Placeholder for dynamically set footer -->
        <hr>
    </div>
        
    <button class="floating-button" onclick="toggleFloatingPopup()">
        <span class="material-icons">menu</span>
    </button>
    <div class="floating-popup" id="floating-popup">
        <ul>
            <li onclick="openWorkloadMatrix()">
                <span class="material-icons">grid_on</span>
                <span id="workloadMatrixLabel"></span>
            </li>
            <li onclick="reorderTasks()">
                <span class="material-icons">reorder</span>
                <span id="reorderTasksLabel"></span>
            </li>
            <li onclick="openFilterPopup()">
                <span class="material-icons">filter_list</span>
                <span id="filterTasksLabel"></span>
            </li>
            <li onclick="openSettings()">
                <span class="material-icons">settings</span>
                <span id="settingsLabel"></span>
            </li>
        </ul>
    </div>

    <div class="overlay" id="workload-overlay" onclick="closeWorkloadMatrix()"></div>
    <div class="workload-matrix-popup" id="workload-matrix-popup">
        <button class="close-button" onclick="closeWorkloadMatrix()">âœ•</button>
        <div class="workload-controls" style="display: none;">
            <h2 id="workloadMatrixTitle">Workload Matrix</h2>
            <label id="selectWeeksLabel" for="weeks">Select Weeks to Display (1-4):</label>
        </div>
        <div class="workload-matrix-container" id="workload-matrix-container">
            <!-- Matrix will be generated here -->
        </div>
    </div>

    <div class="filter-popup" id="filter-popup">
        <span class="close-popup" onclick="closeFilterPopup()">&#10006;</span>
        <h3 id="filterTasksTitle" style="text-align: center; display: none;">Filter Tasks</h3>
        
        <div id="filterSelect" class="filter-tiles-container"></div>
        
        <button onclick="closeFilterPopup()" id="closeFilterButton" style="margin-top: 15px; display: none">Close</button>
    </div>

    <script src="script.js"></script>
</body>
</html>
